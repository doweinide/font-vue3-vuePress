name: Build and Deploy to GitHub Pages # ğŸ“› å·¥ä½œæµç¨‹åç§°

on:
  push:
    branches:
      - master # ğŸŸ¢ å½“ master åˆ†æ”¯æœ‰ push æ—¶è§¦å‘éƒ¨ç½²

permissions:
  contents: read # å…è®¸è¯»å–ä»£ç ä»“åº“å†…å®¹ï¼ˆå¿…é¡»ï¼‰
  pages: write # å…è®¸å†™å…¥ GitHub Pages é¡µé¢ï¼ˆå¿…é¡»ï¼‰
  id-token: write # ç”¨äºéªŒè¯èº«ä»½ï¼Œéƒ¨ç½² Pages æ—¶å¿…é¡»ï¼ˆæ–°ç‰ˆ Pages è¦æ±‚ï¼‰

jobs:
  build: # ğŸ› ï¸ ç¬¬ä¸€ä¸ª Jobï¼šè´Ÿè´£æ„å»º
    runs-on: ubuntu-latest # ä½¿ç”¨ GitHub å®˜æ–¹ Ubuntu æœ€æ–°ç¯å¢ƒ

    steps:
      - uses: actions/checkout@v4 # ç¬¬ä¸€æ­¥ï¼šæ£€å‡ºæºç 

      - name: Setup Node
        uses: actions/setup-node@v4 # è®¾ç½® Node.js ç¯å¢ƒ
        with:
          node-version: 18 # è¿™é‡Œç”¨çš„æ˜¯ Node 18ï¼Œå¯æ ¹æ®é¡¹ç›®éœ€è¦è°ƒæ•´

      - run: npm install # å®‰è£…ä¾èµ–
      - run: npm run build # æ„å»ºé¡¹ç›®ï¼Œç”Ÿæˆé™æ€é¡µé¢æ–‡ä»¶ï¼ˆæ¯”å¦‚ distï¼‰

      - name: Upload artifact
        uses: actions/upload-pages-artifact@v2 # ğŸ“¦ ä¸Šä¼ æ„å»ºäº§ç‰©ï¼ˆArtifactï¼‰ä¾› Pages éƒ¨ç½²ä½¿ç”¨
        with:
          path: ./docs/.vuepress/dist # è®¾ç½®æ„å»ºè¾“å‡ºè·¯å¾„ï¼Œâš ï¸ è¯·æŒ‰å®é™…é¡¹ç›®è°ƒæ•´ï¼

  deploy: # ğŸš€ ç¬¬äºŒä¸ª Jobï¼šéƒ¨ç½²åˆ° GitHub Pages
    needs: build # âœ… ç­‰ build Job å®Œæˆåå†æ‰§è¡Œ
    runs-on: ubuntu-latest # åŒæ ·ä½¿ç”¨ Ubuntu ç¯å¢ƒ
    environment:
      name: github-pages # æŒ‡å®šéƒ¨ç½²åˆ°çš„ç¯å¢ƒåç§°ï¼ˆå¿…é¡»ï¼‰
      url: ${{ steps.deployment.outputs.page_url }} # è‡ªåŠ¨è·å–éƒ¨ç½²æˆåŠŸåçš„é“¾æ¥

    steps:
      - name: Deploy to GitHub Pages
        uses: actions/deploy-pages@v2 # ğŸ“¤ ä½¿ç”¨å®˜æ–¹ Actionï¼Œå°† artifact è‡ªåŠ¨éƒ¨ç½²åˆ° GitHub Pages
        id: deployment # ç»™è¿™ä¸ªæ­¥éª¤å–ä¸ª IDï¼Œç”¨äºåé¢å¼•ç”¨éƒ¨ç½²é“¾æ¥
